@page
@model CinemaWebClient.Pages.Film.Booking.IndexModel
@{
}
<div class="row py-3">
	<div class="col-md-12 py-3">
		<h3>@(Model.Show.Film.Title) <br /> @(Model.Show.ShowDate.ToString("dd/MM/yyyy hh:mm tt"))</h3>
		<h4>Price: @(Model.Show.Price.ToString("C0").Substring(1)) VNĐ</h4>
	</div>
	<div class="col-md-12 py-3">
		<form method="post" class="form-group">
			<div asp-validation-summary="All" class="text-danger"></div>
			@for (int i = 0; i < Model.Show.Room.NumberRow; i++)
			{
				<div>
					@for (int j = 0; j < Model.Show.Room.NumberColumn; j++)
					{
						if (Model.Show.SeatStatus[i * Model.Show.Room.NumberColumn + j] == '1')
						{
							<input class="form-check-inline seats" value="@(i * Model.Show.Room.NumberColumn + j)" type="checkbox" name="seats" checked disabled />
						}
						else
						{
							<input class="form-check-inline seats" value="@(i * Model.Show.Room.NumberColumn + j)" type="checkbox" name="seats"/>
						}
					}
				</div>
			}
			<div class="form-group">
				<input id="totalAmount" class="form-control w-50" value="0" type="text" readonly />
			</div>
			<button class="btn btn-primary" type="submit">Buy</button>
		</form>
	</div>
</div>
@section Scripts {
	<script>
		$(document).ready(function () {
			var price = @(Model.Show.Price);
			var seats = $("input.seats");
			seats.each((v, i) => {
				$(this).on("change", GetAmountPayment);
			})
			function GetAmountPayment() {
				var seatsRemain = seats.filter((v, i) => i.disabled == false)
				var seatsChosen = seatsRemain.filter((v, i) => i.checked == true)
				var totalAmount = price * seatsChosen.length;
				$("#totalAmount").val(formatStringToCurrencyVND(totalAmount+''));
			}
		})
	</script>
}